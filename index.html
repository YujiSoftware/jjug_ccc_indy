<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
    @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
    @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
    @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap');

    body { 
      font-family: 'Noto Sans JP", sans-serif';
    }
    .remark-code, .remark-inline-code {
      font-family: 'Ubuntu Mono';
    }
    .remark-inline-code { 
      font-style: italic;
    }

    .remark-slide-content {
      font-size: 40px; /* 20px */
      padding: 0.5em 2em;
    }
    .remark-slide-content > * {
      margin: 0.25em 0;
    }
    .remark-slide-number {
      display: none; /* ãƒšãƒ¼ã‚¸ç•ªå· */
    }
    .remark-slide-content h1 {
      font-size:60px; /* 55px */
    }
    .remark-slide-content h2 {
      font-size:50px; /* 45px */
    }
    .remark-slide-content h3 {
      font-size:40px; /* 35px */
    }
    .remark-slide-content .highlight {
      color: darkred;
      font-weight: bold;
    }
    .remark-code {
      font-size:36px; /* 18px */
      background-color: #EFEFEF;
    }

    table.border,
    table.border th,
    table.border td {
      padding: 0 0.2em;
      border: 3px solid #444;
      border-collapse: collapse;
    }
    
    .move {
        animation: anim 0.5s ease-out;
    }
    @keyframes anim {
        0% {
            transform: translateX(300px);
        }
        100% {
            transform: translateX(0px);
        }
    }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# Title

---

# Agenda

1. One
2. Two
3. Three
--

4. Four
5. Five
6. Six

---

# æ—¥æœ¬èªãƒ†ã‚¹ãƒˆï¼ˆã“ã“ã‚ãƒ»å¤ç›®æ¼±çŸ³/è‘—ï¼‰

* ç§ã¯ãã®äººã‚’å¸¸ã«å…ˆç”Ÿã¨å‘¼ã‚“ã§ã„ãŸã€‚
* ã ã‹ã‚‰ã“ã“ã§ã‚‚ãŸã å…ˆç”Ÿã¨æ›¸ãã ã‘ã§æœ¬åã¯æ‰“ã¡æ˜ã‘ãªã„ã€‚
* ã“ã‚Œã¯ä¸–é–“ã‚’æ†šã‹ã‚‹é æ…®ã¨ã„ã†ã‚ˆã‚Šã‚‚ã€ãã®æ–¹ãŒç§ã«ã¨ã£ã¦è‡ªç„¶ã ã‹ã‚‰ã§ã‚ã‚‹ã€‚
* ç§ã¯ãã®äººã®è¨˜æ†¶ã‚’å‘¼ã³èµ·ã™ã”ã¨ã«ã€ã™ãã€Œå…ˆç”Ÿã€ã¨ã„ã„ãŸããªã‚‹ã€‚
* ç­†ã‚’åŸ·ã£ã¦ã‚‚å¿ƒæŒã¯åŒã˜äº‹ã§ã‚ã‚‹ã€‚
* ã‚ˆãã‚ˆãã—ã„é ­æ–‡å­—ãªã©ã¯ã¨ã¦ã‚‚ä½¿ã†æ°—ã«ãªã‚‰ãªã„ã€‚

---

# Transform

Java ã®ã©ã“ã§ InvokeDynamic ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ï¼Ÿï¼ˆJava22æ™‚ç‚¹ï¼‰

--

.move[
* Lambda
* Pattern Matching for switch
* Recod class
  * toString, hashCode, equals ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
* String Concatenationï¼ˆJava 9ã€œï¼‰ <!-- https://openjdk.org/jeps/280 -->
  * +æ¼”ç®—å­ã«ã‚ˆã‚‹æ–‡å­—åˆ—çµåˆ
* Refrection APIï¼ˆJava 18 ã€œï¼‰<!-- https://openjdk.org/jeps/416 -->
]

---

# Code

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚µãƒ³ãƒ—ãƒ«
```java
public boolean isOdd(java.util.List<java.lang.Integer>);
  0: aload_1
  1: invokeinterface #7,  1
            // InterfaceMethod java/util/List.stream:()Ljava/util/stream/Stream;
* 6: invokedynamic #13,  0
            // InvokeDynamic #0:test:()Ljava/util/function/Predicate;
 11: invokeinterface #17,  2
            // InterfaceMethod java/util/stream/Stream.allMatch:(Ljava/util/function/Predicate;)Z
 16: ireturn
```

---

class: center, middle

# invoke å‘½ä»¤ã®åŸºæœ¬çš„ãªå‹•ä½œ

---

# ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ç”¨ã®ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰

* invoke**virtual**
* invoke**static**
* invoke**interface**
* invoke**special**
* invoke**dynamic** â† ğŸ†•

ä½•ãŒé•ã†ï¼Ÿ  
ãªã‚“ã§è¿½åŠ ã—ãŸï¼Ÿ

---

# invoke**virtual** ã®å ´åˆ

æŒ‡å®šã•ã‚ŒãŸ**ã‚¯ãƒ©ã‚¹ã¾ãŸã¯ãã®è¦ªã‚¯ãƒ©ã‚¹**ã«ã‚ã‚‹  
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¢ã—ã¦å®Ÿè¡Œ

<br>
```java
  foo.do(1, 2);
    â†“
  invokevirtual #10
      // #10 Method Foo.do:(int, int)V
```

---

# invoke**static** ã®å ´åˆ

æŒ‡å®šã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã«ã‚ã‚‹    
**static ãƒ¡ã‚½ãƒƒãƒ‰**ã‚’æ¢ã—ã¦å®Ÿè¡Œ

<br>
```java
  Foo.do(1, 2);
    â†“
  invokestatic #10
      // #10 Method Foo.do:(int, int)V
```

---

# invoke**interface** ã®å ´åˆ

æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã®**ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹**ã«ã‚ã‚‹  
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¢ã—ã¦å®Ÿè¡Œ

<br>
```java
  foo.do(1, 2);
    â†“
  invokeinterface #10
      // #10 InterfaceMethod Foo.do:(int, int)V
```

---

# invoke**special** ã®å ´åˆ

æŒ‡å®šã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã«ã‚ã‚‹  
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¢ã—ã¦å®Ÿè¡Œ  
ï¼ˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚„è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ãªã©ï¼‰

<br>
```java
  super.do(1, 2);
    â†“
  invokespecial #10
      // #10 Method Foo.do:(int, int)V
```

---

class: center, middle

invoke**virtual**  
invoke**static**  
invoke**interface**  
invoke**special**  
&nbsp; 

## ã“ã‚Œã ã‘ã§ã„ã„ã®ã§ã¯ï¼Ÿ

---

# invokedynamic ã‚’ä½¿ã†å ´é¢

* invokevirtual / interface / static / special ã§ã¯  
å¯¾å¿œã§ããªã„ã¨ã

&nbsp;
<table style="width: 90%; margin-left: 10%;">
  <tr>
    <td style="width: 35%;">&nbsp;</td>
    <td>Foo.do(int a, int b) {...}</td>
  </tr>
  <tr>
    <td>x.do(a, b);</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td style="color: orange;">xã¯Foo? Bar?</td>
    <td>Bar.do(String a, String b) {...}</td>
  </tr>
</table>

---

# æ—¢å­˜ã® invoke å‘½ä»¤ã®åˆ¶é™

æŒ‡å®šã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚„ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‹ã‚‰æ¢ã—ã¦å®Ÿè¡Œ  
â†’ **æŒ‡å®šã—ãªãã¦ã¯ã„ã‘ãªã„**

&nbsp;  
å®Ÿè¡Œæ™‚ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦ã€  
**Foo ã‚¯ãƒ©ã‚¹ or  Bar ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰**  
ã‚’å®Ÿè¡Œã¨ã„ã†ã“ã¨ãŒã§ããªã„

&nbsp;  
ã§ã‚‚ã€ã“ã®ã‚ˆã†ãªã“ã¨ã¯å‹•çš„å‹ä»˜ã‘è¨€èªã§ã¯å¿…é ˆï¼

---

# ç°¡å˜ãªè§£æ±ºæ–¹æ³•

ä¸­é–“å‡¦ç†ã‚’ä½œã‚‹

```java
public static void do(Object r, int x, int y) {
  if (r instanceof Foo) {
    Foo.do(x, y)
  } else if (r instanceof Bar) {
    Bar.do(x, y)
  }
}
```

â†’ ã“ã‚Œã§ã‚‚å•é¡ŒãŒã‚ã‚‹

---

# å•é¡Œç‚¹

1. æ™®é€šã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã«æ¯”ã¹ã¦é…ã„
2. å‹•çš„ã«å¤‰æ›´ã§ããªã„

```java
public static void do(Object r, int x, int y) {
  if (r instanceof Foo) {
    Foo.do(x, y)
  } else if (r instanceof Bar) {
    Bar.do(x, y)
  } else {
    // åˆ¥ã®ã‚¯ãƒ©ã‚¹ã® do ãŒå‘¼ã°ã‚ŒãŸå ´åˆã¯ï¼Ÿ
  }
}
```

---

# æ–°ã—ã„ invoke å‘½ä»¤ã«æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨

1. **ä»»æ„ã®ãƒ¡ã‚½ãƒƒãƒ‰**ã‚’å®Ÿè¡Œã§ãã‚‹
2. ååˆ†ã«**é€Ÿã„**
3. å‹•çš„ã«**å‡¦ç†ã‚’å¤‰æ›´ã§ãã‚‹**

--

&nbsp;   
<div style="color: darkred; font-size: 70px; text-align: center;">ãã‚ŒãŒ invokedynamic ï¼</div>

---

# invokedynamic ã®ç‰¹å¾´ (1)

&nbsp;  
.center.middle[
**<span style="text-decoration: underline;">ä»»æ„ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>**ã‚’å®Ÿè¡Œ  
]

---

# invokedynamic ã®ç‰¹å¾´ (1)

&nbsp;  
.center[
**<span style="text-decoration: underline;">ä»»æ„ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>**ã‚’å®Ÿè¡Œ  
â†“  
å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ±ºã‚ã‚‹ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨æ„ã™ã‚‹
ï¼ˆ**Bootstrap ãƒ¡ã‚½ãƒƒãƒ‰**ï¼‰
]

---

# Bootstrap ãƒ¡ã‚½ãƒƒãƒ‰ã®å½¹å‰²

<span style="text-decoration: underline">ä¸ãˆã‚‰ã‚ŒãŸæƒ…å ±</span>ã‚’ã‚‚ã¨ã«ã€<span style="text-decoration: underline">å®Ÿè¡Œæƒ…å ±(CallSite)</span>ã‚’è¿”ã™  
<span style="margin-left: 3em">â†“</span>
* å¼•æ•°ã®æ•°ã¨å‹æƒ…å ±
* æˆ»ã‚Šå€¤ã®å‹æƒ…å ±
* ãƒ¡ã‚½ãƒƒãƒ‰æ¤œç´¢(Lookup)ã‚¯ãƒ©ã‚¹
* è¿½åŠ æƒ…å ± <!-- recipe-->

&nbsp;  
ã©ã†ã‚„ã£ã¦å®Ÿè¡Œæƒ…å ±ã‚’ç”¨æ„ã™ã‚‹ï¼Ÿ

---

# invokedynamic ã®ç‰¹å¾´ (2)

ååˆ†ã«**é€Ÿã„**  
&nbsp;  
## ç†ç”±

ä¸€å›ç›®ã®å®Ÿè¡Œæ™‚ã¯ã€  
Bootstrap ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰å®Ÿè¡Œæƒ…å ±ã‚’å–å¾—   
<span style="margin-left: 4em">â†“</span>  
äºŒå›ç›®ä»¥é™ã¯ã€å®Ÿè¡Œæƒ…å ±ãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã‘ã‚Œã°   
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ ï¼ˆ= invokevirtual ã¨åŒã˜ï¼‰

---

# invokedynamic ã®ç‰¹å¾´ (3)

å‹•çš„ã«**å‡¦ç†ã‚’å¤‰æ›´ã§ãã‚‹**

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create({
        highlightLines: true,
        highlightStyle: "googlecode",
        ratio: '16:9'
      });
    </script>
  </body>
</html>
